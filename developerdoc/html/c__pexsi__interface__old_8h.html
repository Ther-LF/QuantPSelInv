<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PEXSI: include/pexsi/c_pexsi_interface_old.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://math.berkeley.edu/~linlin/MathJax-2.6/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PEXSI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_ef289e4a44254c13db7b8b2a025c3938.html">pexsi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">c_pexsi_interface_old.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface subroutines of PEXSI that can be called by C.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;mpi.h&gt;</code><br />
</div>
<p><a href="c__pexsi__interface__old_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac6fc083392b52e1ddc256c9b978adfc1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#ac6fc083392b52e1ddc256c9b978adfc1">ReadDistSparseMatrixFormattedHeadInterface</a> (char *filename, int *size, int *nnz, int *nnzLocal, int *numColLocal, MPI_Comm comm)</td></tr>
<tr class="memdesc:ac6fc083392b52e1ddc256c9b978adfc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the sizes of a DistSparseMatrix in formatted form (txt) for allocating memory in C.  <a href="c__pexsi__interface__old_8h.html#ac6fc083392b52e1ddc256c9b978adfc1">More...</a><br /></td></tr>
<tr class="separator:ac6fc083392b52e1ddc256c9b978adfc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a669d924346796ff55d1ce28408a168fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a669d924346796ff55d1ce28408a168fc">ReadDistSparseMatrixFormattedInterface</a> (char *filename, int size, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *nzvalLocal, MPI_Comm comm)</td></tr>
<tr class="memdesc:a669d924346796ff55d1ce28408a168fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reading the data of a formatted DistSparseMatrix.  <a href="c__pexsi__interface__old_8h.html#a669d924346796ff55d1ce28408a168fc">More...</a><br /></td></tr>
<tr class="separator:a669d924346796ff55d1ce28408a168fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac02f3960b6b21cebeffecde1fc777f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a2ac02f3960b6b21cebeffecde1fc777f">ReadDistSparseMatrixHeadInterface</a> (char *filename, int *size, int *nnz, int *nnzLocal, int *numColLocal, MPI_Comm comm)</td></tr>
<tr class="memdesc:a2ac02f3960b6b21cebeffecde1fc777f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the sizes of a DistSparseMatrix in unformatted form (csc) for allocating memory in C.  <a href="c__pexsi__interface__old_8h.html#a2ac02f3960b6b21cebeffecde1fc777f">More...</a><br /></td></tr>
<tr class="separator:a2ac02f3960b6b21cebeffecde1fc777f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e08647166b30e744cac20e9fd3571c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a1e08647166b30e744cac20e9fd3571c3">ParaReadDistSparseMatrixInterface</a> (char *filename, int size, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *nzvalLocal, MPI_Comm comm)</td></tr>
<tr class="memdesc:a1e08647166b30e744cac20e9fd3571c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actual reading the data of a DistSparseMatrix using MPI-IO, assuming that the arrays have been allocated outside this subroutine.  <a href="c__pexsi__interface__old_8h.html#a1e08647166b30e744cac20e9fd3571c3">More...</a><br /></td></tr>
<tr class="separator:a1e08647166b30e744cac20e9fd3571c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a189a1d1c0cc2a6b66777477f68a94a53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a189a1d1c0cc2a6b66777477f68a94a53">PPEXSISelInvInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *HnzvalLocal, int isSIdentity, double *SnzvalLocal, double *zShift, int ordering, int npSymbFact, MPI_Comm comm, double *AinvnzvalLocal, int *info)</td></tr>
<tr class="memdesc:a189a1d1c0cc2a6b66777477f68a94a53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver interface for computing the selected elements of a matrix (in complex arithmietic). <br  />
  <a href="c__pexsi__interface__old_8h.html#a189a1d1c0cc2a6b66777477f68a94a53">More...</a><br /></td></tr>
<tr class="separator:a189a1d1c0cc2a6b66777477f68a94a53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61101933b90def70e0412a0e82ad40c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a61101933b90def70e0412a0e82ad40c3">PPEXSIInertiaCountInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *HnzvalLocal, int isSIdentity, double *SnzvalLocal, double temperature, double numElectronExact, double muMin0, double muMax0, int numPole, int maxIter, double numElectronTolerance, int ordering, int npPerPole, int npSymbFact, MPI_Comm comm, double *muMinInertia, double *muMaxInertia, double *muLowerEdge, double *muUpperEdge, int *numIter, double *muList, double *numElectronList, int *info)</td></tr>
<tr class="memdesc:a61101933b90def70e0412a0e82ad40c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver interface for estimating the chemical potential using inertia counting procedure.  <a href="c__pexsi__interface__old_8h.html#a61101933b90def70e0412a0e82ad40c3">More...</a><br /></td></tr>
<tr class="separator:a61101933b90def70e0412a0e82ad40c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff6cf89b8d319e712793ca6368c3af4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#aaff6cf89b8d319e712793ca6368c3af4">PPEXSIRawInertiaCountInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *HnzvalLocal, int isSIdentity, double *SnzvalLocal, double muMin0, double muMax0, int numPole, int ordering, int npPerPole, int npSymbFact, MPI_Comm comm, double *muList, int *numElectronList, int *info)</td></tr>
<tr class="memdesc:aaff6cf89b8d319e712793ca6368c3af4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Directly compute the negative inertia at a set of shifts.  <a href="c__pexsi__interface__old_8h.html#aaff6cf89b8d319e712793ca6368c3af4">More...</a><br /></td></tr>
<tr class="separator:aaff6cf89b8d319e712793ca6368c3af4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0f3060c85c47693ee5474fdf1fbc6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#afe0f3060c85c47693ee5474fdf1fbc6e">PPEXSISolveInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *HnzvalLocal, int isSIdentity, double *SnzvalLocal, double temperature, double numElectronExact, double mu0, double muMin0, double muMax0, double gap, double deltaE, int numPole, int maxIter, double numElectronTolerance, int ordering, int npPerPole, int npSymbFact, MPI_Comm comm, double *DMnzvalLocal, double *EDMnzvalLocal, double *FDMnzvalLocal, double *muPEXSI, double *numElectronPEXSI, double *muMinPEXSI, double *muMaxPEXSI, int *numIter, double *muList, double *numElectronList, double *numElectronDrvList, int *info)</td></tr>
<tr class="memdesc:afe0f3060c85c47693ee5474fdf1fbc6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main driver routine for solving Kohn-Sham density functional theory using PEXSI.  <a href="c__pexsi__interface__old_8h.html#afe0f3060c85c47693ee5474fdf1fbc6e">More...</a><br /></td></tr>
<tr class="separator:afe0f3060c85c47693ee5474fdf1fbc6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7108b46d0c11093769deaf4690fc7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a2f7108b46d0c11093769deaf4690fc7e">PPEXSILocalDOSInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *HnzvalLocal, int isSIdentity, double *SnzvalLocal, double Energy, double eta, int ordering, int npSymbFact, MPI_Comm comm, double *localDOSnzvalLocal, int *info)</td></tr>
<tr class="memdesc:a2f7108b46d0c11093769deaf4690fc7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver interface for computing the local density of states.  <a href="c__pexsi__interface__old_8h.html#a2f7108b46d0c11093769deaf4690fc7e">More...</a><br /></td></tr>
<tr class="separator:a2f7108b46d0c11093769deaf4690fc7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b12d85efb370dd13661481b3aa42191"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a7b12d85efb370dd13661481b3aa42191">PSelInvRealSymmetricInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *AnzvalLocal, int ordering, int npSymbFact, MPI_Comm comm, int nprow, int npcol, double *AinvnzvalLocal, int *info)</td></tr>
<tr class="memdesc:a7b12d85efb370dd13661481b3aa42191"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simplified driver interface for computing the selected elements of a real symmetric symmetric.  <a href="c__pexsi__interface__old_8h.html#a7b12d85efb370dd13661481b3aa42191">More...</a><br /></td></tr>
<tr class="separator:a7b12d85efb370dd13661481b3aa42191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7fd6f5520b07549614e5ffb287b1ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="c__pexsi__interface__old_8h.html#a8a7fd6f5520b07549614e5ffb287b1ab">PSelInvComplexSymmetricInterface</a> (int nrows, int nnz, int nnzLocal, int numColLocal, int *colptrLocal, int *rowindLocal, double *AnzvalLocal, int ordering, int npSymbFact, MPI_Comm comm, int nprow, int npcol, double *AinvnzvalLocal, int *info)</td></tr>
<tr class="memdesc:a8a7fd6f5520b07549614e5ffb287b1ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simplified driver interface for computing the selected elements of a complex symmetric symmetric.  <a href="c__pexsi__interface__old_8h.html#a8a7fd6f5520b07549614e5ffb287b1ab">More...</a><br /></td></tr>
<tr class="separator:a8a7fd6f5520b07549614e5ffb287b1ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface subroutines of PEXSI that can be called by C. </p>
<p>The FORTRAN interface are wrappers of the C interface. The header file is not needed here, and the interface routines are given directly in <a class="el" href="interface_8cpp.html" title="Interface subroutines of PPEXSI that can be called by both C and FORTRAN.">interface.cpp</a>.</p>
<dl class="section date"><dt>Date</dt><dd>2013-01-31 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1e08647166b30e744cac20e9fd3571c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e08647166b30e744cac20e9fd3571c3">&#9670;&nbsp;</a></span>ParaReadDistSparseMatrixInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ParaReadDistSparseMatrixInterface </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>nzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Actual reading the data of a DistSparseMatrix using MPI-IO, assuming that the arrays have been allocated outside this subroutine. </p>
<p>This routine can be much faster than reading a DistSparseMatrix sequentially, especially compared to the version using formatted input <a class="el" href="interface__old_8cpp.html#a669d924346796ff55d1ce28408a168fc">ReadDistSparseMatrixFormattedInterface</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>(global) Filename for the input matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a61101933b90def70e0412a0e82ad40c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61101933b90def70e0412a0e82ad40c3">&#9670;&nbsp;</a></span>PPEXSIInertiaCountInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PPEXSIInertiaCountInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>HnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isSIdentity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>numElectronExact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muMin0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muMax0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numPole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>numElectronTolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npPerPole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muMinInertia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muMaxInertia</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muLowerEdge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muUpperEdge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>numElectronList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver interface for estimating the chemical potential using inertia counting procedure. </p>
<p>The main purpose of this routine is to obtain two set of intervals.</p>
<p>The first interval is [muMinInertia, muMaxInertia]. This should be a tight interval so that </p><p class="formulaDsp">
\[ N_e(\mathrm{muMinInertia}) \le \mathrm{numElectronExact} \le N_e(\mathrm{muMaxInertia}). \]
</p>
<p> This interval can be used as a bound interval for <a class="el" href="interface__old_8cpp.html#afe0f3060c85c47693ee5474fdf1fbc6e">PPEXSISolveInterface</a>.</p>
<p>The second interval is [muLowerEdge, muUpperEdge]. This interval is defined by </p><p class="formulaDsp">
\[ N_e(\mathrm{muLowerEdge}) = \mathrm{numElectronExact} - eps, \]
</p>
 <p class="formulaDsp">
\[ N_e(\mathrm{muUpppeEdge}) = \mathrm{numElectronExact} + eps. \]
</p>
<p> eps is a small number currently fixed to be 0.1. For metals ( \(N&#39;_e(\mu_{\mathrm{exact}}) &gt; 0\)), it should be expected that muLowerEdge is very close to muUpperEdge. For insulators, ( \(N&#39;_e(\mu_{\mathrm{exact}}) \approx 0\)), we have muUpperEdge &gt; muLowerEdge, with the difference characterizing the band gap.</p>
<p>For either metal or insulator, </p><p class="formulaDsp">
\[ \frac{1}{2} ( \mathrm{muLowerEdge} + \mathrm{muUpperEdge} ) \]
</p>
<p> is a good guess for the chemical potential to be provided to <a class="el" href="interface__old_8cpp.html#afe0f3060c85c47693ee5474fdf1fbc6e">PPEXSISolveInterface</a>.</p>
<p>These intervals are refined for in an iterative procedure, until </p><p class="formulaDsp">
\[ N_e(\mathrm{muMaxInertia}) - N_e(\mathrm{muMinInertia}) &lt; numElectronTolerance. \]
</p>
<p>The counting of the number of electrons (eigenvalues) is obtained by counting the number of negative eigenvalues for the matrix \(H-\mu_l S\) for a series of \(\{\mu_l\}\). The algorithm makes use of Sylvester's law of inertia. <br  />
</p>
<p>Finite temperature effect is also taken into account when computing the number of electrons.</p>
<p><b>Note</b></p><ul>
<li>H and S are always real symmetric matrices, are saved in the compressed sparse column (CSC) format, and have the same sparsity pattern.</li>
<li>This algorithm uses real arithmetic LU decomposition.</li>
<li>The input of S is optional, and the shift z can be 0.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns for H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of H in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isSIdentity</td><td>(global) Whether S is an identity matrix. If so, the variable SnzvalLocal is omitted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero value of S in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">temperature</td><td>(global) Temperature, in the same unit as H </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numElectronExact</td><td>(global) Exact number of electrons, i.e. \(N_e(\mu_{\mathrm{exact}})\). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muMin0</td><td>(global) Initial guess of lower bound for mu </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muMax0</td><td>(global) Initial guess of upper bound for mu </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPole</td><td>(global) Number of shifts (chemical potentials) evaluated at each iteration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxIter</td><td>(global) Maximum number of iterations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numElectronTolerance</td><td>(global) Stopping criterion of the iterations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ordering</td><td>(global) Ordering strategy for factorization and selected inversion. <br  />
<ul>
<li>= 0 : Parallel ordering using ParMETIS/PT-SCOTCH (PARMETIS option in SuperLU_DIST).</li>
<li>= 1 : Sequential ordering using METIS (METIS_AT_PLUS_A option in SuperLU_DIST).</li>
<li>= 2 : Multiple minimum degree ordering (MMD_AT_PLUS_A option in SuperLU_DIST). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npSymbFact</td><td>(global) Number of processors for PARMETIS/PT-SCOTCH. Only used if the ordering = 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muMinInertia</td><td>(global) Lower bound for mu after the inertia count. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muMaxInertia</td><td>(global) Upper bound for mu after the inertia count. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muLowerEdge</td><td>(global) muLowerEdge satisfies N_e(muLowerEdge) = numElectronExact - eps. <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muUpperEdge</td><td>(global) muUpperEdge satisfies N_e(muUpperEdge) = numElectronExact + eps. <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numIter</td><td>(global) Number of iterations used before reaching the stopping criterion. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muList</td><td>(global) Dimension: numIter. The list of shifts after the final iteration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numElectronList</td><td>(global) Dimension: numIter. The number of electrons at the each shift. Finite temperature effect is taken into account. For obtaining the number of electrons without the finite temperature effect, see <a class="el" href="interface__old_8cpp.html#aaff6cf89b8d319e712793ca6368c3af4">PPEXSIRawInertiaCountInterface</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td><ul>
<li>= 0: successful exit. <br  />
</li>
<li>&gt; 0: unsuccessful. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2f7108b46d0c11093769deaf4690fc7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f7108b46d0c11093769deaf4690fc7e">&#9670;&nbsp;</a></span>PPEXSILocalDOSInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PPEXSILocalDOSInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>HnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isSIdentity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDOSnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver interface for computing the local density of states. </p>
<p>The local density of states (LDOS) can be evaluated as </p><p class="formulaDsp">
\[ n(r;E) = \lim_{\eta-&gt;0+} \mathrm{Im} \frac{1}{\pi} \langle r\vert (H-(E+i \eta)I)^{-1} \vert r \rangle. \]
</p>
<p> For nonorthogonal basis functions, this routine returns of the matrix </p><p class="formulaDsp">
\[ \frac{1}{\pi} \mathrm{Im} ( H - (E+i \eta) S )^{-1}, \]
</p>
<p> and the LDOS in the real space can be constructed in the same way that the density is constructed.</p>
<p><b>Note</b></p><ul>
<li>H and S are always real symmetric matrices, are saved in the compressed sparse column (CSC) format, and have the same sparsity pattern.</li>
<li>The input of S is optional, and the shift z can be 0.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns for H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of H in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isSIdentity</td><td>(global) Whether S is an identity matrix. If so, the variable SnzvalLocal is omitted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero value of S in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Energy</td><td>(global) Real part of the shift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>(global) Imaginary part of the shift, or the "broadening" parameter \(\eta\). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ordering</td><td>(global) Ordering strategy for factorization and selected inversion. <br  />
<ul>
<li>= 0 : Parallel ordering using ParMETIS/PT-SCOTCH (PARMETIS option in SuperLU_DIST).</li>
<li>= 1 : Sequential ordering using METIS (METIS_AT_PLUS_A option in SuperLU_DIST).</li>
<li>= 2 : Multiple minimum degree ordering (MMD_AT_PLUS_A option in SuperLU_DIST). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npSymbFact</td><td>(global) Number of processors for PARMETIS/PT-SCOTCH. Only used if the ordering = 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">localDOSnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of the selected elements of \(\frac{1}{\pi} \mathrm{Im} ( H - (E+i \eta) S )^{-1}\). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td><ul>
<li>= 0: successful exit. <br  />
</li>
<li>&gt; 0: unsuccessful. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaff6cf89b8d319e712793ca6368c3af4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaff6cf89b8d319e712793ca6368c3af4">&#9670;&nbsp;</a></span>PPEXSIRawInertiaCountInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PPEXSIRawInertiaCountInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>HnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isSIdentity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muMin0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muMax0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numPole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npPerPole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numElectronList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Directly compute the negative inertia at a set of shifts. </p>
<p>This is a simplified version of <a class="el" href="interface__old_8cpp.html#a61101933b90def70e0412a0e82ad40c3">PPEXSIInertiaCountInterface</a>, without the including the finite temperature effect, or iterative refinement of the chemical potential. This routine can be used for evaluating density of states after <a class="el" href="interface__old_8cpp.html#afe0f3060c85c47693ee5474fdf1fbc6e">PPEXSISolveInterface</a> has reached convergence.</p>
<p>See <a class="el" href="interface__old_8cpp.html#a61101933b90def70e0412a0e82ad40c3">PPEXSIInertiaCountInterface</a> for explanation of parameters. </p>

</div>
</div>
<a id="a189a1d1c0cc2a6b66777477f68a94a53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a189a1d1c0cc2a6b66777477f68a94a53">&#9670;&nbsp;</a></span>PPEXSISelInvInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PPEXSISelInvInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>HnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isSIdentity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>zShift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>AinvnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver interface for computing the selected elements of a matrix (in complex arithmietic). <br  />
 </p>
<p>Evaluate the selected elements of \((H - z S)^{-1}\) for a shift \(z\in\mathbb{C}\).</p>
<p><b>Note</b></p><ul>
<li>H and S are always real symmetric matrices, are saved in the compressed sparse column (CSC) format, and have the same sparsity pattern.</li>
<li>Complex arithmetic operation is used for the factorization and selected inversion even if z is real.</li>
<li>The input of S is optional, and the shift z can be 0.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns for H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of H in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isSIdentity</td><td>(global) Whether S is an identity matrix. If so, the variable SnzvalLocal is omitted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero value of S in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zShift</td><td>(global) Dimension: 2. Use 2 real numbers to denote a complex shift.<ul>
<li>Real part: zShift[0]</li>
<li>Imag part: zShift[1] <br  />
 </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ordering</td><td>(global) Ordering strategy for factorization and selected inversion. <br  />
<ul>
<li>= 0 : Parallel ordering using ParMETIS/PT-SCOTCH (PARMETIS option in SuperLU_DIST).</li>
<li>= 1 : Sequential ordering using METIS (METIS_AT_PLUS_A option in SuperLU_DIST).</li>
<li>= 2 : Multiple minimum degree ordering (MMD_AT_PLUS_A option in SuperLU_DIST). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npSymbFact</td><td>(global) Number of processors for PARMETIS/PT-SCOTCH. Only used if the ordering = 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">AinvnzvalLocal</td><td>(local) Dimension: 2*nnzLocal. Local nonzero values of the selected elements of \((H - z S)^{-1}\).<ul>
<li>Use 2 double for one complex number. This ensures the compatibility with FORTRAN.</li>
<li>Real part: AinvnzvalLocal[2*k]. Imag part: AinvnzvalLocal[2*k+1]. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td><ul>
<li>= 0: successful exit. <br  />
</li>
<li>&gt; 0: unsuccessful. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afe0f3060c85c47693ee5474fdf1fbc6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0f3060c85c47693ee5474fdf1fbc6e">&#9670;&nbsp;</a></span>PPEXSISolveInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PPEXSISolveInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>HnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isSIdentity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>numElectronExact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muMin0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>muMax0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numPole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>numElectronTolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npPerPole</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>DMnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>EDMnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>FDMnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muPEXSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>numElectronPEXSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muMinPEXSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muMaxPEXSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>muList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>numElectronList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>numElectronDrvList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main driver routine for solving Kohn-Sham density functional theory using PEXSI. </p>
<p>Given a good initial guess of the chemical potential and the bound for the chemical potential, this routine uses the Newton method to find the converged chemical potential for a given number of electrons at certain temperature.</p>
<p>After convergence, this routine also returns the density matrix for evaluating the electron density. It also returns the free energy density matrix for evaluating the (Helmholtz or Mermin) free energy, and the energy density matrix for evaluating the atomic force.</p>
<p><b>Note</b></p><ul>
<li>H and S are always real symmetric matrices, are saved in the compressed sparse column (CSC) format, and have the same sparsity pattern.</li>
<li>The input of S is optional, and the shift z can be 0.</li>
<li>The initial guess for the chemical potential mu0, and the lower / upper bounds muMin0 / muMax0 should be obtained from <a class="el" href="interface__old_8cpp.html#a61101933b90def70e0412a0e82ad40c3">PPEXSIInertiaCountInterface</a>, or from heuristics using information from previous steps.</li>
<li><p class="startli">In the current version of the interface routines, the number of processors used for each selected inversion process must be a square number.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>The estimation of deltaE should be estimated in a more automatic way later, using a few steps of Lanczos.</dd></dl>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns for H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of H in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isSIdentity</td><td>(global) Whether S is an identity matrix. If so, the variable SnzvalLocal is omitted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero value of S in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">temperature</td><td>(global) Temperature, in the same unit as H </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numElectronExact</td><td>(global) Exact number of electrons, i.e. \(N_e(\mu_{\mathrm{exact}})\). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu0</td><td>(global) Initial guess for mu. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muMin0</td><td>(global) Initial guess of lower bound for mu. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muMax0</td><td>(global) Initial guess of upper bound for mu. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gap</td><td>(global) A lower bound for the band gap. Currently it is recommended to set this to 0, which works for all systems. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">deltaE</td><td>(global) An upper bound for the spectral radius of \(S^{-1} H\). <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPole</td><td>(global) Number of poles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxIter</td><td>(global) Maximum number of iterations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numElectronTolerance</td><td>(global) Stopping criterion of the iterations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ordering</td><td>(global) Ordering strategy for factorization and selected inversion. <br  />
<ul>
<li>= 0 : Parallel ordering using ParMETIS/PT-SCOTCH (PARMETIS option in SuperLU_DIST).</li>
<li>= 1 : Sequential ordering using METIS (METIS_AT_PLUS_A option in SuperLU_DIST).</li>
<li>= 2 : Multiple minimum degree ordering (MMD_AT_PLUS_A option in SuperLU_DIST). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npPerPole</td><td>(global) Number of processors per pole (ppp). <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npSymbFact</td><td>(global) Number of processors for PARMETIS/PT-SCOTCH. Only used if the ordering = 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DMnzvalLocal</td><td>(local) Dimension: nnzLocal. Nonzero value of density matrix in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">EDMnzvalLocal</td><td>(local) Dimension: nnzLocal. Nonzero value of energy density matrix in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">FDMnzvalLocal</td><td>(local) Dimension: nnzLocal. Nonzero value of free energy density matrix in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muPEXSI</td><td>(global) Chemical potential after the last iteration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numElectronPEXSI</td><td>(global) Number of electrons evaluated at muPEXSI after the last iteration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muMinPEXSI</td><td>(global) Lower bound for mu after the last iteration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muMaxPEXSI</td><td>(global) Upper bound for mu after the last iteration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numIter</td><td>(global) Number of iterations used before reaching the stopping criterion. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">muList</td><td>(global) Dimension: numIter. The history of chemical potential. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numElectronList</td><td>(global) Dimension: numIter. The history of the number of electrons evaluated at each mu in muList. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numElectronDrvList</td><td>(global) Dimension: numIter. The history of the derivative of the number of electrons with respect to mu, evaluated at each mu in muList. This is used in the Newton iteration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td><ul>
<li>= 0: successful exit. <br  />
</li>
<li>&gt; 0: unsuccessful. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8a7fd6f5520b07549614e5ffb287b1ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a7fd6f5520b07549614e5ffb287b1ab">&#9670;&nbsp;</a></span>PSelInvComplexSymmetricInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSelInvComplexSymmetricInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>AnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nprow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>AinvnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simplified driver interface for computing the selected elements of a complex symmetric symmetric. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns for H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AnzvalLocal</td><td>(local) Dimension: 2*nnzLocal. Local nonzero values of A in CSC format. <br  />
<ul>
<li>Use 2 double for one complex number. This ensures the compatibility with FORTRAN. <br  />
</li>
<li>Real part: AnzvalLocal[2*k]. Imag part: AnzvalLocal[2*k+1]. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ordering</td><td>(global) Ordering strategy for factorization and selected inversion. <br  />
<ul>
<li>= 0 : Parallel ordering using ParMETIS/PT-SCOTCH (PARMETIS option in SuperLU_DIST).</li>
<li>= 1 : Sequential ordering using METIS (METIS_AT_PLUS_A option in SuperLU_DIST).</li>
<li>= 2 : Multiple minimum degree ordering (MMD_AT_PLUS_A option in SuperLU_DIST). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npSymbFact</td><td>(global) Number of processors for PARMETIS/PT-SCOTCH. Only used if the ordering = 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. NOTE: mpisize should be equal to nprow * npcol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nprow</td><td>(global) Number of row processors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npcol</td><td>(global) Number of column processors. <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">AinvnzvalLocal</td><td>(local) Dimension: 2*nnzLocal. Local nonzero values of the selected elements of \(A^{-1}\).<ul>
<li>Use 2 double for one complex number. This ensures the compatibility with FORTRAN.</li>
<li>Real part: AinvnzvalLocal[2*k]. Imag part: AinvnzvalLocal[2*k+1]. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td><ul>
<li>= 0: successful exit. <br  />
</li>
<li>&gt; 0: unsuccessful. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7b12d85efb370dd13661481b3aa42191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b12d85efb370dd13661481b3aa42191">&#9670;&nbsp;</a></span>PSelInvRealSymmetricInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PSelInvRealSymmetricInterface </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>AnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ordering</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npSymbFact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nprow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npcol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>AinvnzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simplified driver interface for computing the selected elements of a real symmetric symmetric. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nrows</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros of H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns for H. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of A in CSC format. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ordering</td><td>(global) Ordering strategy for factorization and selected inversion. <br  />
<ul>
<li>= 0 : Parallel ordering using ParMETIS/PT-SCOTCH (PARMETIS option in SuperLU_DIST).</li>
<li>= 1 : Sequential ordering using METIS (METIS_AT_PLUS_A option in SuperLU_DIST).</li>
<li>= 2 : Multiple minimum degree ordering (MMD_AT_PLUS_A option in SuperLU_DIST). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npSymbFact</td><td>(global) Number of processors for PARMETIS/PT-SCOTCH. Only used if the ordering = 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. NOTE: mpisize should be equal to nprow * npcol </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nprow</td><td>(global) Number of row processors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npcol</td><td>(global) Number of column processors. <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">AinvnzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values of the selected elements of \(A^{-1}\). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td><ul>
<li>= 0: successful exit. <br  />
</li>
<li>&gt; 0: unsuccessful. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac6fc083392b52e1ddc256c9b978adfc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6fc083392b52e1ddc256c9b978adfc1">&#9670;&nbsp;</a></span>ReadDistSparseMatrixFormattedHeadInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadDistSparseMatrixFormattedHeadInterface </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the sizes of a DistSparseMatrix in formatted form (txt) for allocating memory in C. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>(global) Filename for the input matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a669d924346796ff55d1ce28408a168fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a669d924346796ff55d1ce28408a168fc">&#9670;&nbsp;</a></span>ReadDistSparseMatrixFormattedInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadDistSparseMatrixFormattedInterface </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>colptrLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>rowindLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>nzvalLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reading the data of a formatted DistSparseMatrix. </p>
<p>This routine assumes that the arrays have been allocated outside this subroutine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>(global) Filename for the input matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">colptrLocal</td><td>(local) Dimension: numColLocal+1. Local column pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rowindLocal</td><td>(local) Dimension: nnzLocal. Local row index pointer in CSC format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nzvalLocal</td><td>(local) Dimension: nnzLocal. Local nonzero values in CSC format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ac02f3960b6b21cebeffecde1fc777f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ac02f3960b6b21cebeffecde1fc777f">&#9670;&nbsp;</a></span>ReadDistSparseMatrixHeadInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadDistSparseMatrixHeadInterface </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nnzLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numColLocal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the sizes of a DistSparseMatrix in unformatted form (csc) for allocating memory in C. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>(global) Filename for the input matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>(global) Number of rows and columns of the matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnz</td><td>(global) Total number of nonzeros. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nnzLocal</td><td>(local) Number of local nonzeros. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">numColLocal</td><td>(local) Number of local columns. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>(global) MPI communicator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jul 1 2022 20:34:01 for PEXSI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
